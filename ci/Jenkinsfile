node {
    triggers { pollSCM('* * * * *') }

    stage('Checkout repo') {
        git url: 'https://github.com/seabornlee/member-service.git',
            branch: 'master'
    }

    stage('Test') {
        sh './mvnw test'
    }
    
    stage('Build API') {
        sh './mvnw package'
    }

    stage('Gen image') {
        sh 'docker build . -t 192.168.1.103:5000/member-service:0.0.$BUILD_NUMBER'
    }
}